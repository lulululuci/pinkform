<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario</title>
    
    <!--aca va el bootstrap-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

    <!--aca va el recaptcha-->
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <!--aca va el mensaje automatico-->
    
    <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
</script>

    <!--aca va la inicializacion del emailjs-->
    <script type="text/javascript">
        (function(){
            emailjs.init({
            publicKey: "pIz6BavMH5IcnMoL7",
            });
        })();
    </script>

</head>

<body>
    <!-- Formulario de contacto -->
    <div class="container mt-5">
        <form id="contactForm" name="contact-form" method="post">
            <!-- Campo de nombre -->
            <div class="mb-3">
                <label for="name" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="name" name="name" required>
            </div>

            <!-- Campo de Email -->
            <div class="mb-3">
                <label for="email" class="form-label">Correo Electrónico</label>
                <input type="email" class="form-control" id="email" name="email" required>
            </div>

            <!-- Campo de asunto -->
            <div class="mb-3">
                <label for="subject" class="form-label">Asunto</label>
                <input type="text" class="form-control" id="subject" name="subject" required>
            </div>

            <!-- Campo de mensaje -->
            <div class="mb-3">
                <label for="message" class="form-label">Mensaje</label>
                <textarea class="form-control" id="message" rows="4" name="message" required></textarea>
            </div>

            <!-- reCaptcha -->
            <div class="mb-3">
                <div class="g-recaptcha" data-sitekey="6LfLQwEsAAAAADCCjeotqG_obecgQlY3fVzgSZ0Z"></div>
            </div>

            <!-- Callback de reCaptcha -->

            <script type="text/javascript">
            var onloadCallback = function() {
                alert("grecaptcha is ready!");
            };
            </script>

            <!-- Botón de envío -->
            <button type="submit" class="btn btn-primary " value="Submit">Enviar</button>

        </form>
    </div>
    <script>
      
    // Script del formulario y el Google Sheets
      
const scriptURL = 'https://script.google.com/macros/s/AKfycbznlXrrkhgodQVUaYgtrAH9gixAlmJSP1WralcxX5TqsIfx9bQG1vZZWaoZzkZHY_Y/exec'

const form = document.forms['contact-form']

form.addEventListener('submit', e => {
  
  e.preventDefault()
  
  // Enviar a Google Sheets
  fetch(scriptURL, { method: 'POST', body: new FormData(form)})
  .then(response => alert("¡Gracias! ¡¡Este formulario fue enviado!!" ))
  .then(() => { window.location.reload(); })
  .catch(error => console.error('Error!', error.message))

    // Enviar con EmailJS
  emailjs.sendForm('service_marxform', 'template_marxform', form)
    .then(() => {
      alert("¡Formulario enviado correctamente!");
      window.location.reload();
    }, (error) => {
      alert("Error al enviar el correo: " + error);
    });
  });
</script>
</body>
</html>
